# 🌐 股票分析Web系统 - 使用指南

## ✨ 特性

- 🌐 **Web界面**：美观的网页界面，无需命令行
- 🔄 **一键刷新**：每次刷新都重新获取真实数据
- 🤖 **AI分析**：智谱AI智能分析股票图形
- 📊 **实时数据**：腾讯财经API实时行情
- 🎯 **智能识别**：自动检测图形类型

---

## 🚀 快速开始

### 1. 安装Flask

```bash
pip install flask
```

### 2. 启动Web服务

```bash
python3 app.py
```

### 3. 访问网页

打开浏览器访问：**http://127.0.0.1:5000**

---

## 📱 界面功能

### 快速分析按钮

点击预设股票即可立即分析：
- 601138 - 工业富联
- 600519 - 贵州茅台
- 002594 - 比亚迪
- 600036 - 招商银行
- 300750 - 宁德时代

### 自定义分析

1. 输入股票代码（如：601138）
2. 点击"🔍 分析"按钮
3. 系统自动：
   - 从腾讯财经API获取实时数据
   - 检测图形类型
   - 使用智谱AI分析
   - 显示完整结果

### 刷新功能 🔄

点击"🔄 刷新数据"按钮：
- 重新获取该股票的实时数据
- 重新检测图形类型
- 重新进行AI分析
- **每次刷新都是最新数据！**

---

## 🎨 界面展示

### 1. 股票信息卡片

显示：
- 开盘价、实时价、最高价
- 涨跌幅（绿涨红跌）
- 成交量
- 更新时间

### 2. 图形识别

显示：
- 识别的图形类型
- 置信度
- 识别原因

### 3. AI分析（智谱AI）

显示：
- 分析结果
- 风险评估
- 操作建议

### 4. 操作建议

对于不适合分析的状态（强势上涨、震荡整理）：
- 显示当前状态
- 提供操作建议
- 不进行图形分析

---

## 🔄 刷新机制

### 自动刷新场景

1. **盘中监控**：每30秒点击一次刷新
2. **开盘后**：立即刷新获取最新数据
3. **尾盘前**：刷新获取收盘数据

### 刷新逻辑

```
用户点击刷新
    ↓
获取腾讯财经API实时数据 ← 最新行情！
    ↓
自动检测图形类型
    ↓
调用智谱AI分析
    ↓
更新页面显示
```

### 数据更新时间

每次刷新都会显示更新时间，格式：`2026-01-31 19:30:45`

---

## 💡 使用场景

### 场景1：开盘快速检查

```
09:30 - 输入股票代码，点击分析
09:35 - 点击刷新，查看最新数据
09:40 - 再次刷新，持续监控
```

### 场景2：尾盘复盘

```
14:55 - 刷新获取尾盘数据
15:00 - 再次刷新确认收盘价
```

### 场景3：多股轮换

```
分析 601138 → 刷新 → 分析 600519 → 刷新 → 分析 002594
```

---

## 🔧 技术架构

### 前端

- **框架**：原生JavaScript（无需安装）
- **样式**：CSS3渐变动画
- **响应式**：适配手机和电脑

### 后端

- **框架**：Flask
- **数据源**：腾讯财经API
- **AI模型**：智谱GLM-4-Plus

### API接口

| 接口 | 方法 | 说明 |
|------|------|------|
| `/` | GET | 显示主页 |
| `/api/analyze` | POST | 分析单只股票 |
| `/api/batch_analyze` | POST | 批量分析 |

---

## 📋 API示例

### 分析单只股票

```javascript
fetch('/api/analyze', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({stock_code: '601138'})
})
.then(response => response.json())
.then(result => console.log(result));
```

### 批量分析

```javascript
fetch('/api/batch_analyze', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
        stock_codes: ['601138', '600519', '002594']
    })
})
.then(response => response.json())
.then(result => console.log(result));
```

---

## ⚠️ 注意事项

### 1. 交易时间

- **最佳使用时间**：交易时间（9:30-15:00）
- **非交易时间**：显示前一交易日收盘数据

### 2. 刷新频率

- 建议间隔：**10-30秒**
- 过于频繁可能被API限制

### 3. 浏览器兼容

- ✅ Chrome
- ✅ Firefox
- ✅ Safari
- ✅ Edge

---

## 🐛 故障排除

### 问题1：无法启动服务

```bash
# 检查Flask是否安装
pip install flask

# 检查端口5000是否被占用
lsof -i :5000
```

### 问题2：无法获取数据

```bash
# 测试API连接
curl http://qt.gtimg.cn/list=sh601138

# 检查网络连接
ping qt.gtimg.cn
```

### 问题3：AI分析失败

- 检查 `.env` 文件中的API密钥
- 查看终端的错误信息
- 确认网络连接正常

---

## 🎯 快速测试

### 1. 启动服务

```bash
python3 app.py
```

### 2. 访问网页

浏览器打开：http://127.0.0.1:5000

### 3. 测试分析

- 点击"601138"按钮，或
- 输入"601138"，点击"分析"

### 4. 刷新测试

- 观察"实时价"和"涨跌幅"
- 点击"🔄 刷新数据"
- 确认数据已更新

---

## 📊 与命令行工具对比

| 特性 | Web界面 | 命令行 |
|------|---------|--------|
| 易用性 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| 可视化 | ⭐⭐⭐⭐⭐ | ⭐⭐ |
| 快速操作 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| 批量分析 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 自动化 | ⭐⭐ | ⭐⭐⭐⭐⭐ |

---

## 📞 技术支持

### 相关文件

- `app.py` - Flask后端应用
- `templates/index.html` - Web界面
- `.env` - API密钥配置

### 启动命令

```bash
# 启动Web服务
python3 app.py

# 访问地址
# http://127.0.0.1:5000
# 或 http://localhost:5000
```

---

## 🎓 高级用法

### 自定义端口

修改 `app.py` 最后一行：

```python
app.run(host='0.0.0.0', port=8080, debug=False)
```

### 外网访问

```python
app.run(host='0.0.0.0', port=5000, debug=False)
```

然后访问：`http://你的IP:5000`

### 部署到服务器

1. 上传代码到服务器
2. 安装依赖：`pip install flask zhipuai requests`
3. 配置 `.env` 文件
4. 运行：`python3 app.py`
5. 使用Gunicorn等部署到生产环境

---

**🎉 享受智能股票分析！每次刷新都是最新数据！**
